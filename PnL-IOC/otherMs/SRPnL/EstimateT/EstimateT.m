function sol = EstimateT(inputR)
%ESTIMATET Summary of this function goes here
%   Detailed explanation goes here
    R =  inputR;

    syms X Y Z 

    f = 512;

    PW0 = [256, 0, 256];
%     p0 = [279.0507 297.7435 1];
    p0 = [279 297 1];



    PW1 = [256, 0, Z];
%     p1 =[1.3811 470.9088 1];
    p1 =[1 470 1];



    PW2 = [256, Y, 256];
    % p2 = [278.1006 16.9544 1];
%     p2 = [278.0513 2.3916 1];
    p2 = [278 2 1];

%     testp0 = T1A*[R T]*[256, 105, 256,1]';
%     testp0 = testp0/testp0(3);

    PW3 = [X, 0, 256];
%     p3 = [634.9015 491.0976 1];
    p3 = [635 490 1];

%     A = [0 0 0 f 0 -p0(1);...
%          0 0 0 0 f -p0(2);...
%          0 0 f*R(1,3)-p1(1)*R(3,3) f 0 -p1(1);...
%          0 0 f*R(2,3)-p1(2)*R(3,3) 0 f -p1(2);...
%          0 f*R(1,2)-p2(1)*R(3,2) 0 f 0 -p2(1);...
%          0 f*R(2,2)-p2(2)*R(3,2) 0 0 f -p2(2);...
%          f*R(1,1)-p3(1)*R(3,1) 0 0 f 0 -p3(1);...
%          f*R(2,1)-p3(2)*R(3,1) 0 0 0 f -p3(2);...
%          ];
% 
%     b = -[ f*R(1,1)*PW0(1)+f*R(1,2)*PW0(2)+f*R(1,3)*PW0(3)-p0(1)*R(3,1)*PW0(1)-p0(1)*R(3,2)*PW0(2)-p0(1)*R(3,3)*PW0(3);...
%           f*R(2,1)*PW0(1)+f*R(2,2)*PW0(2)+f*R(2,3)*PW0(3)-p0(2)*R(3,1)*PW0(1)-p0(2)*R(3,2)*PW0(2)-p0(2)*R(3,3)*PW0(3);...
%           f*R(1,1)*PW1(1)+f*R(1,2)*PW1(2)-p1(1)*R(3,1)*PW1(1)-p1(1)*R(3,2)*PW1(2);...
%           f*R(2,1)*PW1(1)+f*R(2,2)*PW1(2)-p1(2)*R(3,1)*PW1(1)-p1(2)*R(3,2)*PW1(2);...
%           f*R(1,1)*PW2(1)+f*R(1,3)*PW2(3)-p2(1)*R(3,1)*PW2(1)-p2(1)*R(3,3)*PW2(3);...
%           f*R(2,1)*PW2(1)+f*R(2,3)*PW2(3)-p2(2)*R(3,1)*PW2(1)-p2(2)*R(3,3)*PW2(3);...
%           f*R(1,2)*PW3(2)+f*R(1,3)*PW3(3)-p3(1)*R(3,2)*PW3(2)-p3(1)*R(3,3)*PW3(3);...
%           f*R(2,2)*PW3(2)+f*R(2,3)*PW3(3)-p3(2)*R(3,2)*PW3(2)-p3(2)*R(3,3)*PW3(3);...
%           ]  

    A = [0 f 0 -p0(1);...
         0 0 f -p0(2);...
%          0 f*R(1,3)-p1(1)*R(3,3) f 0 -p1(1);...
%          0 f*R(2,3)-p1(2)*R(3,3) 0 f -p1(2);...
%          f*R(1,2)-p2(1)*R(3,2) 0 f 0 -p2(1);...
%          f*R(2,2)-p2(2)*R(3,2) 0 0 f -p2(2);...
         f*R(1,1)-p3(1)*R(3,1) f 0 -p3(1);...
         f*R(2,1)-p3(2)*R(3,1) 0 f -p3(2);...
         ];

    b = -[ f*R(1,1)*PW0(1)+f*R(1,2)*PW0(2)+f*R(1,3)*PW0(3)-p0(1)*R(3,1)*PW0(1)-p0(1)*R(3,2)*PW0(2)-p0(1)*R(3,3)*PW0(3);...
          f*R(2,1)*PW0(1)+f*R(2,2)*PW0(2)+f*R(2,3)*PW0(3)-p0(2)*R(3,1)*PW0(1)-p0(2)*R(3,2)*PW0(2)-p0(2)*R(3,3)*PW0(3);...
%           f*R(1,1)*PW1(1)+f*R(1,2)*PW1(2)-p1(1)*R(3,1)*PW1(1)-p1(1)*R(3,2)*PW1(2);...
%           f*R(2,1)*PW1(1)+f*R(2,2)*PW1(2)-p1(2)*R(3,1)*PW1(1)-p1(2)*R(3,2)*PW1(2);...
% %           f*R(1,1)*PW2(1)+f*R(1,3)*PW2(3)-p2(1)*R(3,1)*PW2(1)-p2(1)*R(3,3)*PW2(3);...
%           f*R(2,1)*PW2(1)+f*R(2,3)*PW2(3)-p2(2)*R(3,1)*PW2(1)-p2(2)*R(3,3)*PW2(3);...
          f*R(1,2)*PW3(2)+f*R(1,3)*PW3(3)-p3(1)*R(3,2)*PW3(2)-p3(1)*R(3,3)*PW3(3);...
          f*R(2,2)*PW3(2)+f*R(2,3)*PW3(3)-p3(2)*R(3,2)*PW3(2)-p3(2)*R(3,3)*PW3(3);...
          ]  
            
      
    b = double(b);
      
      
      x =A\b
      x1 = linsolve(A,b)
      s1 = lsqminnorm(A,b,1e-2)

%     M = [A -b];
%     [U, S, V] =  svd(M);
%     v1 = V(:,7)/V(7,7)
%     v2 = V(:,6)/V(7,6)
%     v3 = V(:,5)/V(7,5)
%     v4 = V(:,4)/V(7,4)
%     v5 = V(:,3)/V(7,3)
%     v6 = V(:,2)/V(7,2)
%     v7 = V(:,1)/V(7,1)


    %constaints based on the layout 
%     lb = [257;1;257;0;0;0];
%     ub = [512;256;512;512;512;512];

    lb = [257;0;0;0];
    ub = [512;512;512;512];

    sol = lsqlin(A,b,[],[],[],[],lb,ub)

    re = double(A*sol - b)
    
%     testx = [325.3896 90.9324 355.7906 173.7394 66.1482 507.6516]';
%     
%     re1 = double(A*testx - b)
      
end

